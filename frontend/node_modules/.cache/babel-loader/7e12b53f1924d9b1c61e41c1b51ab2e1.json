{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Admin/Projects/my-wallet/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Users/Admin/Projects/my-wallet/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/Admin/Projects/my-wallet/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Admin/Projects/my-wallet/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import styles from'./AddCard.module.scss';import{Button,FormControl,InputLabel,MenuItem,Select,TextField,Typography}from'@mui/material';import{useForm}from'react-hook-form';import{addCard}from'../../api/mainApi';import DatePicker from'../DatePicker';import{useCurrency}from'../../hooks/currency.hook';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Index=function Index(_ref){var _errors$number,_errors$number2,_errors$cvv,_errors$cvv2,_errors$holder,_errors$holder2,_errors$amount,_errors$amount2;var getUserData=_ref.getUserData,setPage=_ref.setPage;var _useState=useState(new Date()),_useState2=_slicedToArray(_useState,2),selectedDate=_useState2[0],setSelectedDate=_useState2[1];var _useCurrency=useCurrency(),currency=_useCurrency.currency,selectedCurrency=_useCurrency.selectedCurrency,getAvailableCurrency=_useCurrency.getAvailableCurrency,handleSelectChange=_useCurrency.handleSelectChange;var checkCard=function checkCard(value){var check=!(value.replace(/\\D/g,'').split('').reverse().reduce(function(a,d,i){return a+d*(i%2?2.2:1)|0;},0)%10);if(!check){return\"Не валідна картка\";}return check;};var maxLength=function maxLength(e,_maxLength){e.target.value=Math.max(parseInt(e.target.value)).toString().slice(0,_maxLength);};var minLength=function minLength(value){var min=arguments.length>1&&arguments[1]!==undefined?arguments[1]:3;return value.length===min?true:\"\\u041F\\u043E\\u0442\\u0440\\u0456\\u0431\\u043D\\u043E \\u043C\\u0456\\u043D\\u0456\\u043C\\u0443\\u043C \".concat(min,\" \\u0441\\u0438\\u043C\\u0432\\u043E\\u043B\\u0438\");};var _useForm=useForm({defaultValues:{number:'',cvv:'',holder:'',amount:''},mode:'onBlur'}),register=_useForm.register,handleSubmit=_useForm.handleSubmit,_useForm$formState=_useForm.formState,errors=_useForm$formState.errors,isValid=_useForm$formState.isValid;var onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(values){var expDate;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:expDate=selectedDate.toLocaleDateString().slice(-7).replace(\".\",\"/\").replace('20','');_context.next=3;return addCard(_objectSpread({currency:selectedCurrency,expDate:expDate},values)).then(function(data){getUserData().then();setPage('CardsInfo');}).catch(function(err){return console.log(err);});case 3:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x){return _ref2.apply(this,arguments);};}();useEffect(function(){getAvailableCurrency();},[getAvailableCurrency]);return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",className:styles.title,children:\"\\u0414\\u043E\\u0434\\u0430\\u0432\\u0430\\u043D\\u043D\\u044F \\u043A\\u0430\\u0440\\u0442\\u043A\\u0438\"}),/*#__PURE__*/_jsx(\"div\",{className:styles.row,children:/*#__PURE__*/_jsx(TextField,_objectSpread({required:true,fullWidth:true,type:'number',inputProps:{maxLength:12},label:\"Card number\",variant:\"outlined\",onInput:function onInput(e){return maxLength(e,16);},error:!!((_errors$number=errors.number)!==null&&_errors$number!==void 0&&_errors$number.message),helperText:(_errors$number2=errors.number)===null||_errors$number2===void 0?void 0:_errors$number2.message},register('number',{validate:checkCard,required:'Вкажіть номер картки',minLength:16})))}),/*#__PURE__*/_jsxs(\"div\",{className:styles.row,children:[/*#__PURE__*/_jsx(DatePicker,{selectedDate:selectedDate,setSelectedDate:setSelectedDate}),/*#__PURE__*/_jsx(TextField,_objectSpread({required:true,fullWidth:true,type:'number',label:\"CVV\",variant:\"outlined\",onInput:function onInput(e){return maxLength(e,3);},error:!!((_errors$cvv=errors.cvv)!==null&&_errors$cvv!==void 0&&_errors$cvv.message),helperText:(_errors$cvv2=errors.cvv)===null||_errors$cvv2===void 0?void 0:_errors$cvv2.message},register('cvv',{required:'Вкажіть CVV',validate:minLength})))]}),/*#__PURE__*/_jsx(\"div\",{className:styles.row,children:/*#__PURE__*/_jsx(TextField,_objectSpread({fullWidth:true,label:\"Card holder\",variant:\"outlined\",error:!!((_errors$holder=errors.holder)!==null&&_errors$holder!==void 0&&_errors$holder.message),helperText:(_errors$holder2=errors.holder)===null||_errors$holder2===void 0?void 0:_errors$holder2.message},register('holder')))}),/*#__PURE__*/_jsxs(\"div\",{className:styles.row,children:[/*#__PURE__*/_jsx(TextField,_objectSpread({required:true,fullWidth:true,type:'number',label:\"amount\",variant:\"outlined\",error:!!((_errors$amount=errors.amount)!==null&&_errors$amount!==void 0&&_errors$amount.message),helperText:(_errors$amount2=errors.amount)===null||_errors$amount2===void 0?void 0:_errors$amount2.message},register('amount',{required:'Вкажіть баланс'}))),/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Currency\"}),/*#__PURE__*/_jsx(Select,{label:\"currency\",value:selectedCurrency,onChange:handleSelectChange,children:currency===null||currency===void 0?void 0:currency.map(function(elem,index){return/*#__PURE__*/_jsx(MenuItem,{value:elem,children:elem},index);})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.row,children:[/*#__PURE__*/_jsx(Button,{variant:'contained',type:'submit',color:'primary',disabled:!isValid,children:\"\\u0414\\u043E\\u0434\\u0430\\u0442\\u0438 \\u043A\\u0430\\u0440\\u0442\\u043A\\u0443\"}),/*#__PURE__*/_jsx(Button,{variant:'contained',color:'error',onClick:function onClick(){return setPage('CardsInfo');},children:\"\\u0421\\u043A\\u0430\\u0441\\u0443\\u0432\\u0430\\u0442\\u0438\"})]})]});};export default Index;","map":{"version":3,"names":["React","useEffect","useState","styles","Button","FormControl","InputLabel","MenuItem","Select","TextField","Typography","useForm","addCard","DatePicker","useCurrency","Index","getUserData","setPage","Date","selectedDate","setSelectedDate","currency","selectedCurrency","getAvailableCurrency","handleSelectChange","checkCard","value","check","replace","split","reverse","reduce","a","d","i","maxLength","e","target","Math","max","parseInt","toString","slice","minLength","min","length","defaultValues","number","cvv","holder","amount","mode","register","handleSubmit","formState","errors","isValid","onSubmit","values","expDate","toLocaleDateString","then","data","catch","err","console","log","title","row","message","validate","required","map","elem","index"],"sources":["C:/Users/Admin/Projects/my-wallet/frontend/src/components/AddCard/index.js"],"sourcesContent":["import React, { useEffect, useState} from 'react';\r\nimport styles from './AddCard.module.scss';\r\nimport {Button, FormControl, InputLabel, MenuItem, Select, TextField, Typography} from '@mui/material';\r\nimport {useForm} from 'react-hook-form';\r\nimport {addCard} from '../../api/mainApi';\r\nimport DatePicker from '../DatePicker';\r\nimport {useCurrency} from '../../hooks/currency.hook';\r\n\r\nconst Index = ({getUserData, setPage}) => {\r\n  const [selectedDate, setSelectedDate] = useState(new Date());\r\n  const {currency, selectedCurrency, getAvailableCurrency, handleSelectChange} = useCurrency();\r\n\r\n  const checkCard = (value) => {\r\n    const check = !(value.replace(/\\D/g, '').split('').reverse().reduce(function(a, d, i) {\r\n      return a + d * (i % 2 ? 2.2 : 1) | 0;\r\n    }, 0) % 10);\r\n    if (!check) {\r\n      return \"Не валідна картка\"\r\n    }\r\n    return check;\r\n  };\r\n\r\n  const maxLength = (e, maxLength) => {\r\n    e.target.value = Math.max(parseInt(e.target.value)).toString().slice(0, maxLength)\r\n  };\r\n\r\n  const minLength = (value, min = 3) => {\r\n    return  value.length === min ? true : `Потрібно мінімум ${min} символи`;\r\n  }\r\n\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    formState: {errors, isValid},\r\n  } = useForm({\r\n    defaultValues: {number: '', cvv: '', holder: '', amount: ''},\r\n    mode: 'onBlur',\r\n  });\r\n\r\n  const onSubmit = async (values) => {\r\n    const expDate = selectedDate.toLocaleDateString().slice(-7).replace(\".\", \"/\").replace('20', '');\r\n    await addCard({currency: selectedCurrency, expDate, ...values})\r\n      .then(data => {\r\n        getUserData().then();\r\n        setPage('CardsInfo');\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n\r\n  useEffect(() => {\r\n    getAvailableCurrency();\r\n  }, [getAvailableCurrency]);\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit(onSubmit)}>\r\n      <Typography variant=\"h5\" className={styles.title}>\r\n        Додавання картки\r\n      </Typography>\r\n      <div className={styles.row}>\r\n        <TextField required={true} fullWidth type={'number'} inputProps={{maxLength: 12}} label=\"Card number\" variant=\"outlined\"\r\n                   onInput={(e) => maxLength(e, 16)}\r\n                   error={!!errors.number?.message}\r\n                   helperText={errors.number?.message}\r\n                   {...register('number', {validate: checkCard, required: 'Вкажіть номер картки', minLength: 16 } )}\r\n        />\r\n      </div>\r\n      <div className={styles.row}>\r\n        <DatePicker selectedDate={selectedDate} setSelectedDate={setSelectedDate}/>\r\n        <TextField required={true} fullWidth type={'number'} label=\"CVV\" variant=\"outlined\"\r\n                   onInput={(e) => maxLength(e, 3)}\r\n                   error={!!errors.cvv?.message}\r\n                   helperText={errors.cvv?.message}\r\n                   {...register('cvv', {required: 'Вкажіть CVV', validate: minLength})}\r\n        />\r\n      </div>\r\n      <div className={styles.row}>\r\n        <TextField fullWidth label=\"Card holder\" variant=\"outlined\"\r\n                   error={!!errors.holder?.message}\r\n                   helperText={errors.holder?.message}\r\n                   {...register('holder')}\r\n        />\r\n      </div>\r\n      <div className={styles.row}>\r\n        <TextField required={true} fullWidth type={'number'} label=\"amount\" variant=\"outlined\"\r\n                   error={!!errors.amount?.message}\r\n                   helperText={errors.amount?.message}\r\n                   {...register('amount', {required: 'Вкажіть баланс'})}\r\n        />\r\n        <FormControl fullWidth>\r\n          <InputLabel>Currency</InputLabel>\r\n          <Select\r\n            label=\"currency\"\r\n            value={selectedCurrency}\r\n            onChange={handleSelectChange}\r\n          >\r\n            {currency?.map((elem, index) => <MenuItem key={index} value={elem}>{elem}</MenuItem>)}\r\n          </Select>\r\n        </FormControl>\r\n      </div>\r\n      <div className={styles.row}>\r\n        <Button variant={'contained'} type={'submit'} color={'primary'} disabled={!isValid}>Додати картку</Button>\r\n        <Button variant={'contained'} color={'error'} onClick={() => setPage('CardsInfo')}>Скасувати</Button>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default Index;"],"mappings":"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"},"metadata":{},"sourceType":"module"}